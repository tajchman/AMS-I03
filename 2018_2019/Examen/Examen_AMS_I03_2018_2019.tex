\documentclass[12pt]{report}
\setlength{\textwidth}{450pt}
\setlength{\textheight}{600pt}
\setlength{\oddsidemargin}{0pt}
\usepackage[T1]{fontenc}
\usepackage{listings}
\usepackage{fancyhdr}
\pagestyle{fancy}
\parindent 0pt
\lstset{ 
   keepspaces=true,
   language=C++,
   numbers=left
}

\def\Frac#1#2{\frac{\displaystyle #1}{\displaystyle #2}}
\newcounter{cptPoints}

\newcounter{cptQuestions}
\newcommand\question[2]{\bigskip\par\addtocounter{cptQuestions}{1}\addtocounter{cptPoints}{#2}{\bf Question #1 n\textsuperscript{o} \thecptQuestions} (#2 points)\par}

\newcounter{cptProblems}
\newcommand\problem[1]{\bigskip\rule{3cm}{.1pt}\par\addtocounter{cptProblems}{1}{\bf Probl\` eme n\textsuperscript{o} \thecptProblems \ (#1)}\medskip\par}

\begin{document}
	\lhead{\bf ENSTA - Master AMS M2 - Cours I03}
	\rhead{\bf 2018-2019}
	\begin{center}\Large\bf
			Examen du cours I3\\
			Programmation hybride et multi-c\oe urs\\[0.4cm]
			Vendredi 15 f\'evrier 2019 - dur\'ee 3 heures\\
			Supports de cours autoris\'es.
		\end{center}
	\bigskip
	Dans les questions o\`u on demande d'\'ecrire des lignes de code, les erreurs de syntaxe ne seront pas prises en compte (ponctuation, nom exact des fonctions, ordre des arguments, etc.). Du moment que vous indiquez clairement ce que fait chaque ligne de code ajout\'ee pour r\'epondre aux questions.
		
	\bigskip
	
	\question{}2
	\medskip
	
	D\'efinir les localit\'es spatiale et temporelle.
	
	Des deux versions suivantes du code qui calcule le produit matrice-vecteur, laquelle sera probablement plus rapide pour [\tt n] grand ? M\^eme question pour [\tt n] petit ?
	
	\lstinputlisting[language=C++]{Q2/maxlocal.hxx}
	
	
	\question{}5
	\medskip
	
	   On veut parall\'eliser avec OpenMP, la fonction C++ :
	\lstinputlisting[language=C++]{Q2/maxlocal.hxx}
	
	\begin{quotation}\noindent%
		Le but de cette fonction est de calculer, sur les composantes d'un vecteur {\tt v}, les indices des {\tt maxima locaux} ($i$ tels que $v_i > v_{i-1}$ et $v_i > v_{i+1}$).
		
		\noindent%
		On suppose que le nombre de maxima locaux est inf\'erieur \`a la taille du vecteur d'entiers {\tt imax} (dans lequel seront rang\'es les indices de maxima locaux).
	\end{quotation}
	 
 La parall\'elisation de cette fonction en ajoutant une pragma simple suivant le mod\`ele ``OpenMP grain fin'' est impossible (le compilateur refuse de compiler quand on ajoute la pragma), ou en tout cas compliqu\'ee.
 
	 \begin{itemize}
	 	\item Expliquer pourquoi.
	 	\item Modifier la fonction en la parall\'elisant suivant le mod\`ele ``OpenMP grain grossier''.
	 	\item La version parall\`ele fournit un r\'esultat correct mais peut-\^etre diff\'erent de celui de la version s\'equentielle. Quelle est cette diff\'erence ?
	 	\item Question optionnelle : Indiquer une m\'ethode pour obtenir si possible un r\'esultat identique.
	 \end{itemize}
	 
         
\bigskip \rule{3cm}{.1pt}

Total : \thecptPoints \ points
 
\end{document}
